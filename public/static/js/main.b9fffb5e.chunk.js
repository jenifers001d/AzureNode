(window.webpackJsonpoutlookcalendar=window.webpackJsonpoutlookcalendar||[]).push([[0],{37:function(e,t,n){e.exports=n(54)},42:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(27),o=n.n(i),c=(n(42),n(10)),s=n(11),l=n(13),u=n(12),d=n(14),m=n(6),f=n(32),h=n(18),p=n(4),v=n.n(p),g=n(64),b=n(65),E=n(56),y=n(7),x=(n(44),n(55)),k=n(57),O=n(58),j=n(59),w=n(60),S=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.url;return r.a.createElement("div",null,r.a.createElement(x.a,{color:"dark",dark:!0,expand:"md",fixed:"top"},r.a.createElement(E.a,null,r.a.createElement(k.a,{href:"/"},"BOOKING WEB APP"),r.a.createElement(O.a,{navbar:!0},r.a.createElement(j.a,null,this.props.showRegister?r.a.createElement(w.a,{href:e,target:"_blank"},"Register"):null)))))}}]),t}(r.a.Component),N=n(61),T=n(62),A=n(63);function C(){var e=Object(m.a)(["\n  flex-grow: 1;\n  margin: 15px 10px 0px;\n"]);return C=function(){return e},e}function D(){var e=Object(m.a)(["\n  flex-grow: 1;\n  margin: 10px 10px 0px;\n"]);return D=function(){return e},e}function I(){var e=Object(m.a)(["\n  display: flex;\n"]);return I=function(){return e},e}function B(){var e=Object(m.a)(["\n  text-align: center;\n"]);return B=function(){return e},e}function M(){var e=Object(m.a)(["\n  margin: 10px auto;\n"]);return M=function(){return e},e}var P=y.a.div(M()),R=y.a.h2(B()),W=y.a.div(I()),L=y.a.div(D()),H=y.a.div(C()),Z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={userName:null,userEmail:null,selectedServiceName:null,selectedServiceId:null,serviceNotes:""},n.inputName=function(e){n.setState({userName:e.target.value},function(){n.props.getInfo(n.state)})},n.inputEmail=function(e){var t="";e.target.value&&(t=null!==e.target.value.match(/^[a-zA-Z0-9.!#$%&\u2019*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/i)?e.target.value:"NotRightFormat");n.setState({userEmail:t},function(){n.props.getInfo(n.state)})},n.selectService=function(e){var t=e.target.selectedIndex,a=e.target.options[t];n.setState({selectedServiceName:e.target.value,selectedServiceId:a.id},function(){n.props.getInfo(n.state)})},n.inputserviceNotes=function(e){n.setState({serviceNotes:e.target.value},function(){n.props.getInfo(n.state)})},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.services;return r.a.createElement(P,null,r.a.createElement(R,null,"Information"),r.a.createElement(W,null,r.a.createElement(L,null,r.a.createElement(N.a,null,r.a.createElement(T.a,{type:"text",name:"userName",id:"userName",placeholder:"Name (Required)",onChange:this.inputName})),r.a.createElement(N.a,null,r.a.createElement(T.a,{type:"email",name:"email",id:"email",placeholder:"Email (Required)",onChange:this.inputEmail})),r.a.createElement(N.a,null,r.a.createElement(A.a,{for:"select"},"Select Service"),r.a.createElement(T.a,{type:"select",name:"select",id:"select",onChange:this.selectService},e?e.map(function(e){return r.a.createElement("option",{key:e.id,id:e.id},e.displayName)}):""))),r.a.createElement(H,null,r.a.createElement(N.a,null,r.a.createElement(A.a,{for:"exampleText"},"Please let me know if you have any special requests."),r.a.createElement(T.a,{type:"textarea",name:"text",id:"exampleText",rows:"5",onChange:this.inputserviceNotes})))))}}]),t}(r.a.Component);function F(){var e=Object(m.a)(["\n  width: 35px;\n  height: 35px;\n  text-align: center;\n  line-height: 33px;\n  :hover {\n    border-radius: 50%;\n    background-color: #0088ff;\n    color: white;\n  }\n"]);return F=function(){return e},e}function U(){var e=Object(m.a)(["\n  border-top-right-radius: 10px;\n  border-top-left-radius: 10px;\n  background-color: #89c8ff;\n  padding: 5px;\n  display: flex;\n  justify-content: space-between;\n  line-height: 33px;\n"]);return U=function(){return e},e}var z=y.a.div(U()),Y=y.a.div(F());var q=function(e){var t=e.current,n=v()(t).startOf("week"),a=v()(t).endOf("week"),i=v()(n).format("D")+"-"+v()(a).format("D");return r.a.createElement(z,null,r.a.createElement(Y,{onClick:function(){return e.prevWeek(t)}}," ","<"," "),r.a.createElement("div",null,i+" "+v()(t).format("MMM YYYY")),r.a.createElement(Y,{onClick:function(){return e.nextWeek(t)}}," ",">"," "))};function J(){var e=Object(m.a)(["\n  border: 1px dashed rgb(228, 228, 228);\n  width: 100%;\n  height: 12px;\n  text-align: center;\n  line-height: 26px;\n  margin: 1px 0px;\n  transition: all 0.05s ease-in-out;\n"]);return J=function(){return e},e}var $=y.a.div(J()),G=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={time:n.props.time,isPicked:null,isHovered:!1},n.checkAfterToday=function(){var e=n.state.time,t=v()(new Date).startOf("day"),a=e.diff(t,"days"),r=e.days();return a>0&&0!==r&&6!==r},n.handleClick=function(e){n.setState({isSelected:!0})},n.handleMouseEnter=function(e){e.target.value=n.state.time,n.setState({isHovered:!0})},n.handleMouseLeave=function(e){n.setState({isHovered:!1})},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.time,a=t.isHovered,i=this.props,o=i.isBusy,c=i.tempBookTime,s="";return this.checkAfterToday()&&o?s="busy":this.checkAfterToday()&&!1===o&&(s="mouse-on"),this.checkAfterToday()&&c.tempStartTime<=n&&n<c.tempEndTime&&(o||(s+=" selecting")),r.a.createElement($,{title:a?v()(n).format("hh:mm A"):"",className:s,value:n,onClick:function(t){return e.props.handleClick(t,e.checkAfterToday(),!o)},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave})}}]),t}(r.a.Component);function K(){var e=Object(m.a)(["\n  border: 1px dashed rgb(228, 228, 228);\n  width: 100%;\n  height: 25px;\n  text-align: center;\n  line-height: 24px;\n  margin: 1px 0px;\n"]);return K=function(){return e},e}function _(){var e=Object(m.a)([""]);return _=function(){return e},e}function Q(){var e=Object(m.a)(["\n  padding: 5px 20px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-around;\n"]);return Q=function(){return e},e}function V(){var e=Object(m.a)(["\n  font-size: 20px;\n"]);return V=function(){return e},e}function X(){var e=Object(m.a)(["\n  margin: 5px 10px;\n  width: 14.2%;\n  height: 45px;\n  line-height: 23px;\n"]);return X=function(){return e},e}function ee(){var e=Object(m.a)(["\n  width: 100%;\n  margin: 0px 2.5px;\n"]);return ee=function(){return e},e}var te=y.a.div(ee()),ne=y.a.div(X()),ae=y.a.div(V()),re=y.a.div(Q()),ie=y.a.div(_()),oe=y.a.div(K()),ce=["8:00","8:30","9:00","9:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30"],se=15,le=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={tempBookTime:{tempStartTime:null,tempEndTime:null}},n.handleClick=function(e,t,a){var r=60*se*1e3;t&&a?n.setState({tempBookTime:{tempStartTime:e.target.value,tempEndTime:v()(e.target.value+r)},mouseIsDown:!0},function(){n.props.getDate(n.state.tempBookTime)}):alert("Please choose another day.")},n.renderCells=function(e,t,a){var i=se,o=8,c=0,s=17,l=0;if(a){var u=/\d+/g,d=a[0].start.match(u),m=a[0].end.match(u);o=d[0],c=d[1],s=m[0],l=m[1]}for(var f,h=v()(e).hour(8).minute(0).second(0).millisecond(0),p=v()(e).hour(17).minute(0).second(0).millisecond(0),g=v()(e).hour(o).minute(c).second(0).millisecond(0),b=v()(e).hour(s).minute(l).second(0).millisecond(0),E=[],y=h,x=0;y<p;){if(f=!1,(y.diff(g,"minutes")<0||y.diff(b,"minutes")>=0)&&(f=!0),x<t.length){var k=t[x].start.diff(y,"minutes")<=0,O=t[x].end.diff(y,"minutes")>0;if(k&&O&&(f=!0),0===t[x].end.diff(y,"minutes")){x++;continue}}E.push(r.a.createElement(G,{key:y,time:y,isBusy:f,tempBookTime:n.state.tempBookTime,handleClick:n.handleClick})),y=v()(y).add(i,"m")}return r.a.createElement(ie,null,E)},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){for(var e,t,n,a,i=this,o=this.props,c=o.current,s=o.events,l=o.business,u=v()(c).day(0),d=[],m=function(o){e=v()(u).add(o,"d");var c=void 0,m=void 0;if(l&&(c=v()(u).days(l.businessHours[o].day),m=l.businessHours[o].timeSlots,c.days()===e.days()&&0===m.length))return"continue";t="",n=v()(e),(a=n.diff(new Date,"hours"))<0?t="before":0===a&&(t="today"),0!==n.days()&&6!==n.days()||(t+=" no-work-day");var f=[];s.forEach(function(e){n.date()===v()(e.start).date()&&f.push({start:v()(e.start),end:v()(e.end)})}),d.push(r.a.createElement(te,{key:o,className:t},r.a.createElement(ne,null,r.a.createElement("div",null,v()(e).format("ddd")),r.a.createElement(ae,null,v()(e).format("D"))),i.renderCells(e,f,m)))},f=0;f<7;f++)m(f);return r.a.createElement(re,null,r.a.createElement(te,null,r.a.createElement(ne,null),r.a.createElement(ie,null,ce.map(function(e){return r.a.createElement(oe,{key:e},e)}))),d)}}]),t}(r.a.Component);function ue(){var e=Object(m.a)(["\n  width: 97%;\n  border-top: 1px dashed red;\n  position: relative;\n  top: -282.5px;\n"]);return ue=function(){return e},e}function de(){var e=Object(m.a)(["\n  border-top-right-radius: 10px;\n  border-top-left-radius: 10px;\n  box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.2);\n  position: relative;\n"]);return de=function(){return e},e}var me=y.a.div(de()),fe=y.a.hr(ue()),he=[],pe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currentMonth:new Date,eventsArr:[],isCheckEvents:!1},n.storeEvents=function(e){he=[],e.forEach(function(e){he.push({start:e.start.dateTime,end:e.end.dateTime})}),0!==n.state.eventsArr.length||n.state.isCheckEvents||n.setState({eventsArr:he,isCheckEvents:!0})},n.processMSTime=function(e){for(var t=e.match(/(\d+[dhms]+)(\d*[hms]*)(\d*[ms]*)(\d*[s]*)/i),n={},a=[],r=1;r<=4;r++)n={},""!==t[r]&&(n.num=t[r].slice(0,-1),n.duration=t[r].slice(-1),a.push(n));for(var i,o=0,c=0;c<a.length;c++)switch(i=parseInt(a[c].num),a[c].duration){case"S":o+=i;break;case"M":o+=60*i;break;case"H":o+=60*i*60;break;case"D":o+=60*i*60*24;break;default:console.log("no matching duration with"+a[c].duration)}return o},n.prevWeek=function(e){var t=v()(new Date).startOf("day"),a=v()(e).startOf("day").diff(t,"days");0<a&&a<=7&&n.setState({currentMonth:v()(e).subtract(1,"w")})},n.nextWeek=function(e){var t=v()(new Date).startOf("day"),a=v()(e).startOf("day").diff(t,"days");0<=a&&a<7&&n.setState({currentMonth:v()(e).add(1,"w")})},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){null!==this.props.events&&0===he.length&&this.storeEvents(this.props.events)}},{key:"render",value:function(){var e=this.state,t=e.currentMonth,n=e.eventsArr;return r.a.createElement(r.a.Fragment,null,r.a.createElement(me,null,r.a.createElement(q,{current:t,prevWeek:this.prevWeek,nextWeek:this.nextWeek}),r.a.createElement(le,{current:t,business:this.props.business,events:n,getDate:this.props.getSelectedDate}),r.a.createElement(fe,null)))}}]),t}(r.a.Component);function ve(){var e=Object(m.a)(["\n  height: 75vh;\n  display: flex;\n  text-align: center;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return ve=function(){return e},e}function ge(){var e=Object(m.a)([""]);return ge=function(){return e},e}function be(){var e=Object(m.a)(["\n  width: 100vw;\n  height: 100vh;\n  background-color: white;\n  position: relative;\n  top: -71px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return be=function(){return e},e}function Ee(){var e=Object(m.a)(["\n  margin: 0px auto 10px;\n  display: flex;\n  justify-content: center;\n"]);return Ee=function(){return e},e}var ye=Object(y.a)(g.a)(Ee()),xe=y.a.div(be()),ke=Object(y.a)(b.a)(ge()),Oe=y.a.div(ve()),je=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={business:null,calendarEvents:null,services:null,regisURL:null,selectedDate:null,userInfo:{userName:null,userEmail:null,selectedServiceName:null,selectedServiceId:null,serviceNotes:""},isLoad:!1},n.getURLandBookingsData=function(){fetch("/url").then(function(e){return e.text()}).then(function(e){fetch("/book").then(function(e){return e.json()}).then(function(t){n.setState({business:t.business,calendarEvents:t.events,services:t.services,regisURL:e,isLoad:!0})})})},n.getSelectedDate=function(e){n.setState({selectedDate:e})},n.getInfo=function(e){n.setState({userInfo:e})},n.sentData=function(){var e=n.state,t=e.services,a=e.selectedDate,r=e.userInfo,i=null,o=null;r.selectedServiceName?(i=r.selectedServiceName,o=r.selectedServiceId):t&&(i=t[0].displayName,o=t[0].id);var c=r.userName&&r.userEmail;a&&c?"NotRightFormat"!==r.userEmail?(alert("Thank you for using BOOKING WEB APP.\nPlease wait for 5 sec ..."),fetch("/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({"@odata.type":"#microsoft.graph.bookingAppointment",customerEmailAddress:r.userEmail,customerName:r.userName,customerNotes:"Please be on time.",customerPhone:"213-555-0199",end:{"@odata.type":"#microsoft.graph.dateTimeTimeZone",dateTime:v()(a.tempEndTime).format(),timeZone:"Australia/Brisbane"},serviceId:o,serviceName:i,serviceNotes:r.serviceNotes,start:{"@odata.type":"#microsoft.graph.dateTimeTimeZone",dateTime:v()(a.tempStartTime).format(),timeZone:"Australia/Brisbane"}})}).then(function(e){window.location.reload()})):alert("Format of Email is wrong!"):null===a?alert("Please choose time~"):alert("Please input Name and Email!")},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getURLandBookingsData()}},{key:"render",value:function(){var e=this,t=this.state,n=t.business,a=t.calendarEvents,i=t.services,o=t.regisURL,c=t.isLoad,s="hidden",l="";console.log(n),console.log(a),console.log(i),c||(l="hidden",s="");var u=c&&null===n&&null===a&&null===i;return r.a.createElement(r.a.Fragment,null,r.a.createElement(xe,{className:s},r.a.createElement(ke,{color:"primary"})),r.a.createElement("div",{className:l},r.a.createElement(S,{url:o,showRegister:u}),r.a.createElement(E.a,null,u?r.a.createElement(Oe,null,r.a.createElement("h1",null,"There is no data in the database"),r.a.createElement("h1",null,"Administrator have to register at first !")):r.a.createElement(f.a,null,r.a.createElement(h.a,{exact:!0,path:"/",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{services:i,getInfo:e.getInfo}),r.a.createElement(pe,{business:e.state.business,events:e.state.calendarEvents,getSelectedDate:e.getSelectedDate}),r.a.createElement(ye,{color:"primary",onClick:e.sentData},"Sent Book"))}})))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(je,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[37,1,2]]]);
//# sourceMappingURL=main.b9fffb5e.chunk.js.map